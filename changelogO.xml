<?xml version="1.1" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.10.xsd">

  <!-- ********************************************************************* -->
  <!-- ******************JDBC runWith Changes ****************************** -->
  <!-- ********************************************************************* -->
  <changeSet author="Liquibase Pro User" id="1::runSQLTableWithJDBC" runWith="jdbc">
    <sql dbms="oracle" endDelimiter=";" splitStatements="true" stripComments="true">
      CREATE TABLE employees
      (
        employee_id NUMBER PRIMARY KEY,
        first_name  VARCHAR(255) NOT NULL,
        last_name   VARCHAR(255) NOT NULL,
        email       VARCHAR(255) NOT NULL,
        phone       VARCHAR(50)  NOT NULL,
        hire_date   DATE         NOT NULL,
        manager_id  NUMBER( 12, 0 ), -- fk
        job_title   VARCHAR(255) NOT NULL,
        CONSTRAINT fk_employees_manager
          FOREIGN KEY (manager_id)
            REFERENCES employees (employee_id)
            ON DELETE CASCADE
      );
    </sql>
  </changeSet>

  <changeSet author="Liquibase Pro User"
    id="2::runXMLTableWithJDBC" runWith="jdbc">
    <createTable tableName="pepes">
      <column name="pepe_id" type="NUMBER">
        <constraints primaryKey="true"/>
      </column>
      <column name="first_name" type="VARCHAR2(50 BYTE)"/>
      <column name="last_name" type="VARCHAR2(50 BYTE)"/>
    </createTable>
  </changeSet>

  <changeSet author="Liquibase Pro User" id="3::runFileTableWithJDBC" runWith="jdbc">
    <sqlFile dbms="oracle" endDelimiter=";" splitStatements="false" relativeToChangelogFile="true" path="sql/lbpro_runWith_table.sql"/>
  </changeSet>

  <changeSet author="Liquibase Pro User" id="4::runSQLTableWithRollbackWithJDBC" runWith="jdbc">
    <sql dbms="oracle" endDelimiter=";" splitStatements="true" stripComments="true">
      CREATE TABLE partyparrots
      (
        partyparrot_id NUMBER,
        first_name     VARCHAR2(50) NOT NULL,
        last_name      VARCHAR2(50) NOT NULL,
        PRIMARY KEY (partyparrot_id)
      );
    </sql>
    <rollback>
      <sqlFile endDelimiter=";" path="sql/lbpro_runWith_table_rollback.sql" splitStatements="true" stripComments="true"/>
    </rollback>
  </changeSet>

  <changeSet author="Liquibase Pro User" id="5::run3SQLTableWithJDBC" runWith="jdbc">
    <sql dbms="oracle" endDelimiter=";" splitStatements="true" stripComments="true">
      CREATE TABLE doggies
      (
        doggy_id   NUMBER,
        first_name VARCHAR2(50) NOT NULL,
        last_name  VARCHAR2(50) NOT NULL,
        PRIMARY KEY (doggy_id)
      );
    </sql>
    <sql dbms="oracle" endDelimiter=";" splitStatements="true" stripComments="true">
      CREATE TABLE slothies
      (
        sloth_id   NUMBER,
        first_name VARCHAR2(50) NOT NULL,
        last_name  VARCHAR2(50) NOT NULL,
        PRIMARY KEY (sloth_id)
      );
    </sql>
    <sql dbms="oracle" endDelimiter=";" splitStatements="true" stripComments="true">
      CREATE TABLE murderofcrows
      (
        crow_id    NUMBER,
        first_name VARCHAR2(50) NOT NULL,
        last_name  VARCHAR2(50) NOT NULL,
        PRIMARY KEY (crow_id)
      );
    </sql>
  </changeSet>

  <changeSet author="Liquibase Pro User" id="6::runSQLViewWithJDBC" runWith="jdbc">
    <sql dbms="oracle" endDelimiter=";" splitStatements="true" stripComments="true">
      CREATE VIEW employee_yos AS
      SELECT
        employee_id,
        first_name || ' ' || last_name full_name,
        FLOOR( months_between( CURRENT_DATE, hire_date )/ 12 ) yos
      FROM
        employees;
    </sql>
  </changeSet>

  <changeSet author="Liquibase Pro User"
    id="7::runFullDefViewWithJDBC" objectQuotingStrategy="QUOTE_ALL_OBJECTS" runWith="jdbc">
    <createView fullDefinition="true"
      viewName="PEPEVIEW">CREATE OR REPLACE FORCE VIEW PEPEVIEW (first_name) AS SELECT first_name FROM "pepes"</createView>
  </changeSet>

  <changeSet author="Liquibase Pro User" id="8::runFileProcWithJDBC" objectQuotingStrategy="QUOTE_ALL_OBJECTS" runWith="jdbc">
    <createProcedure path="sql/lbpro_runWith_proc.sql" procedureName="PROC_HELLO_WORLD"/>
  </changeSet>

  <changeSet author="Liquibase Pro User" id="9::runSQLProcWithJDBC" objectQuotingStrategy="QUOTE_ALL_OBJECTS" runWith="jdbc">
    <sql dbms="oracle" endDelimiter="/" splitStatements="true" stripComments="true">
      CREATE OR REPLACE PROCEDURE "SECOND_PROC" AS
      BEGIN
  DBMS_OUTPUT.PUT_LINE('Second proc!');
      END SECOND_PROC
      /
    </sql>
  </changeSet>

  <changeSet author="Liquibase Pro User" id="10::runFullDefProcWithJDBC" objectQuotingStrategy="QUOTE_ALL_OBJECTS" runWith="jdbc">
    <createProcedure fullDefinition="true" procedureName="THIRD_PROC">CREATE OR REPLACE PROCEDURE "THIRD_PROC" AS
    BEGIN
  DBMS_OUTPUT.PUT_LINE('Third proc!');
    END THIRD_PROC</createProcedure>
  </changeSet>

</databaseChangeLog>
